{"version":3,"sources":["roam_wiki/roam.cljs"],"mappings":"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","names":["roam-wiki.roam/url","js/window.location.href","js/console.log","roam-wiki.roam/graph-name","tail","cljs.core/re-find","cljs.core/last","clojure.string/includes?","roam-wiki.roam/base-url","head","roam-wiki.roam/base-page-url","roam-wiki.roam/current-user-email","js/localStorage.getItem","js/JSON.parse","cljs.core/seq","cljs.core.nth","roam-wiki.roam/api","js/roamAlphaAPI","var_args","args__4824__auto__","len__4818__auto__","i__4819__auto__","argseq__4825__auto__","cljs.core/IndexedSeq","roam-wiki.roam/q","seq26568","G__26569","cljs.core/first","cljs.core/next","self__4805__auto__","q","o","args","cljs.core/cons","clojure.string/replace","cljs.core.pr_str","cljs.core.apply","roam-wiki.roam/query","seq26570","self__4806__auto__","cljs.core.js__GT_clj","roam-wiki.roam/current-user-page","roam_wiki.roam.query","roam-wiki.roam/current-user-page-uid","roam-wiki.roam/current-user-page-name","roam-wiki.roam/get-page-url","uid","roam-wiki.roam/left-sidebar","js/document.querySelector","roam-wiki.roam/left-sidebar-top-row","roam-wiki.roam/custom-sidebar-wrapper","goog.dom/createDom","roam-wiki.roam/insert-custom-sidebar-wrapper!","roam-wiki.roam/clear-left-sidebar!","cljs.core.mapv","goog.dom/removeNode","js/document.querySelectorAll","roam-wiki.roam/roam-main","roam-wiki.roam/roam-body-main","roam-wiki.roam/clear-body-main","goog.dom/removeChildren","roam-wiki.roam/user-todos","name","roam-wiki.roam/mount-block!","node","roam-wiki.roam/unmount-node!"],"sourcesContent":["(ns roam-wiki.roam\n  [:require\n   [clojure.string :as str]\n   [goog.dom :as gdom]])\n\n(def url js/window.location.href)\n\n(js/console.log url)\n\n;; (def url \"https://roamresearch.com/#/app/notemap/page/07-26-2021\")\n\n(def graph-name\n  (let [tail (->> url\n                  (re-find #\"(#/app/)(.+)\")\n                  (last))]\n    (if (clojure.string/includes? tail \"/\")\n      (last (re-find #\"^(.*?)/\" tail))\n      tail)))\n\n(js/console.log \"ahoj\")\n\n(def base-url\n  (let [head (->> url\n                  (re-find #\"(.*)#\")\n                  (last))]\n    (str head \"#/app/\" graph-name)))\n\n(def base-page-url\n  (str base-url \"/page/\"))\n\n(def current-user-email\n  (-> \"globalAppState\"\n      (js/localStorage.getItem)\n      (js/JSON.parse)\n      (seq)\n      (last)\n      (nth 2)))\n\n(def api js/roamAlphaAPI)\n\n(defn q [q & o]\n  (let [args (cons (str/replace (pr-str q) #\"\\n\" \" \") o)]\n    (apply (.. api -data -q) args)))\n\n(defn query [& args]\n  (-> (apply q args)\n      (js->clj :keywordize-keys true)))\n\n(def current-user-page\n  (-> (query '[:find (pull ?p [*])\n               :in $ email\n               :where\n               [?p :block/children ?b]\n               [?b :block/refs ?ep]\n               [?ep :node/title \"email\"]\n               [?b :block/string ?bs]\n               [(clojure.string/includes? ?bs email)]] current-user-email)\n      (first)\n      (first)))\n\n(def current-user-page-uid\n  (:uid current-user-page))\n\n(def current-user-page-name\n  (:title current-user-page))\n\n(defn get-page-url [uid]\n  (str base-page-url uid))\n\n(def left-sidebar (js/document.querySelector \".roam-sidebar-content\"))\n\n(def left-sidebar-top-row (js/document.querySelector \".top-row\"))\n\n(def custom-sidebar-wrapper (gdom/createDom \"div\" #js{:id \"roam-wiki-sidebar\"}))\n\n(defn insert-custom-sidebar-wrapper! []\n  (.insertBefore left-sidebar custom-sidebar-wrapper (. left-sidebar-top-row -nextSibling)))\n\n(defn clear-left-sidebar! []\n  (mapv gdom/removeNode (js/document.querySelectorAll \".log-button\")))\n\n(defn roam-main [] (js/document.querySelector \".roam-main\"))\n\n(defn roam-body-main [] (js/document.querySelector \".roam-body-main\"))\n\n(defn clear-body-main []\n  (gdom/removeChildren (roam-body-main)))\n\n(defn user-todos [name]\n  (query '[:find (pull ?t [*])\n           :in $ ?n\n           :where [?t :block/refs ?np]\n           [?t :block/refs ?tp]\n           [?np :node/title ?n]\n           [?tp :node/title \"TODO\"]] name))\n\n(defn mount-block! [uid node]\n  (.renderBlock (.. api -ui -components) #js{:uid uid :el node}))\n\n(defn unmount-node! [node]\n  (js/console.log \"unmounting\")\n  (.unmountNode (.. api -ui -components) #js{:el node}))"]}